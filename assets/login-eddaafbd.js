import{a as q,x as M,y as $,b as B,r as T,z as A,B as H,e as n,f as I,g as a,D as O,o as L,c as e,h as x,E as j,m as F,M as V,G as z,H as D,J as K,K as N}from"./index-b5662a28.js";import"//at.alicdn.com/t/c/font_4262358_tx308o415h8.js";const k=q({__name:"login",emits:["changeType"],setup(f,{emit:u}){const l=M(),i=$(),_=()=>{V.confirm({title:"账号未注册，是否注册？",icon:e(z),okText:"立即注册",okType:"primary",cancelText:"不用了",onOk(){console.log(u),u("changeType")},onCancel(){console.log("Cancel")}})},p=B({username:"",password:"",remember:!0}),g=T(null);T("");const d=t=>{const{password:o,username:r,remember:h}=t;function U(y){if(y){const{password:S}=y;o===S?(console.log("密码正确"),i.$patch(v=>{v.username=r,v.password=o,v.isLogin=!0}),j({username:r,password:o,isLogin:!0}),l.push("/")):(F.error("密码错误"),g.value.focus())}else console.log("不存在"),_()}O("user_list","username",r,U)},s=t=>{console.log("Failed:",t)},w=(t,{password:o})=>{g.value.focus()},c=(t,o)=>o.value.toUpperCase().indexOf(t.toUpperCase())>=0,m=T([]),b=t=>{m.value=t.map(o=>({value:o.username,password:o.password}))};return A(()=>{H("user_list").then(t=>{t&&b(t)})}),(t,o)=>{const r=n("a-auto-complete"),h=n("a-form-item"),U=n("a-input-password"),y=n("a-button"),S=n("a-space"),v=n("a-form");return L(),I(v,{model:p,name:"basic","label-col":{span:4},"wrapper-col":{span:18},autocomplete:"off",onFinish:d,onFinishFailed:s},{default:a(()=>[e(h,{label:"账号",name:"username",rules:[{required:!0,message:"请输入你的用户名"}]},{default:a(()=>[e(r,{value:p.username,"onUpdate:value":o[0]||(o[0]=C=>p.username=C),options:m.value,placeholder:"请输入你的账号","filter-option":c,onSelect:w},null,8,["value","options"])]),_:1}),e(h,{label:"密码",name:"password",rules:[{required:!0,message:"请输入你的密码"}]},{default:a(()=>[e(U,{value:p.password,"onUpdate:value":o[1]||(o[1]=C=>p.password=C),ref_key:"passwordIpt",ref:g},null,8,["value"])]),_:1}),e(h,{"wrapper-col":{offset:10,span:2}},{default:a(()=>[e(S,{direction:"vertical"},{default:a(()=>[e(y,{type:"primary","html-type":"submit"},{default:a(()=>[x("登录")]),_:1}),e(y,{type:"default",onClick:o[2]||(o[2]=C=>u("changeType"))},{default:a(()=>[x("注册")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])}}}),R={__name:"register",emits:["changeType"],setup(f,{emit:u}){const l=B({username:"",password:"",passwordCopy:""}),i=d=>{const{password:s,username:w}=d;D({username:w,password:s},({msg:c,status:m})=>{m===200?(console.log("注册成功"),F.success("注册成功 立即登录"),u("changeType")):F.error(c||"注册失败")})},_=d=>{console.log("Failed:",d)},g={username:[{required:!0,message:"请输入你的用户名"}],password:[{required:!0,message:"请输入你的密码"}],passwordCopy:[{required:!0,validator:async(d,s)=>s===""?Promise.reject("请再次输入你的密码"):s!==l.password?Promise.reject("两次输入的密码不一致"):Promise.resolve(),trigger:"change"}]};return(d,s)=>{const w=n("a-input"),c=n("a-form-item"),m=n("a-input-password"),b=n("a-button"),t=n("a-space"),o=n("a-form");return L(),I(o,{model:l,name:"basic","label-col":{span:6},"wrapper-col":{span:16},rules:g,autocomplete:"off",onFinish:i,onFinishFailed:_},{default:a(()=>[e(c,{label:"账号",name:"username"},{default:a(()=>[e(w,{value:l.username,"onUpdate:value":s[0]||(s[0]=r=>l.username=r),valueModifiers:{lazy:!0},autofocus:"",placeholder:"用户名"},null,8,["value"])]),_:1}),e(c,{label:"密码",name:"password"},{default:a(()=>[e(m,{value:l.password,"onUpdate:value":s[1]||(s[1]=r=>l.password=r),placeholder:"密码"},null,8,["value"])]),_:1}),e(c,{label:"确认密码",name:"passwordCopy"},{default:a(()=>[e(m,{value:l.passwordCopy,"onUpdate:value":s[2]||(s[2]=r=>l.passwordCopy=r),placeholder:"确认密码"},null,8,["value"])]),_:1}),e(c,{"wrapper-col":{offset:8,span:14}},{default:a(()=>[e(t,null,{default:a(()=>[e(b,{type:"default",onClick:s[3]||(s[3]=r=>u("changeType"))},{default:a(()=>[x("返回登录")]),_:1}),e(b,{type:"primary","html-type":"submit"},{default:a(()=>[x("注册")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])}}},P=R;const J=q({name:"login",components:{Login:k,Register:P},setup(){const f=T("login"),[u,l]=F.useMessage(),i=K();i!=null&&i.isLogin&&(N.push("/"),u.info("Hello, Ant Design Vue!"));const _=()=>{f.value="register"},p=()=>{f.value="login"};return()=>e("div",{class:"full"},[e(n("a-row"),{justify:"center",align:"middle"},{default:()=>[e(n("a-col"),{span:8},{default:()=>[e(n("a-card"),{style:"width:100%;"},{default:()=>[f.value==="login"?e(k,{onChangeType:_},null):e(P,{onChangeType:p},null)]})]})]})])}});export{J as default};
